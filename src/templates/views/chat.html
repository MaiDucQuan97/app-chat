<!DOCTYPE html>
<html>

<head>
    <title>Chat realtime NodeJS demo</title>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/mustache.js/3.0.1/mustache.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qs/6.6.0/qs.min.js"></script>
    <script src="/socket.io/socket.io.js"></script>
    <script src="/js/jquery.min.js"></script>
    <script type="module" src="/js/chat.js"></script>
    <script src="/js/service-worker.js"></script>

    <link rel="stylesheet" href="/css/chat.css">
    <link rel="stylesheet" href="/css/reaction-icon.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.5.0/semantic.min.css"
        integrity="sha512-KXol4x3sVoO+8ZsWPFI/r5KBVB/ssCGB5tsv2nVOKwLg33wTFP3fmnXa47FdSVIshVTgsYk/1734xSk9aFIa4A=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>

<body>
    <div class="chat" id="chat">
        <!-- <div class="chat__navbar">
            <div class="menu">
                <a href="/index">Homepage</a>
                <a href="/login">Login</a>
                <a href="/signup">Signup</a>
            </div>
            <div id="logout-btn">
                <button>Logout</button>
            </div>
        </div> -->

        <div class="chat__sidebar">
            <div class="user__informations">
                <div class="info__image">
                    <img src="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEABsbGxscGx4hIR4qLSgtKj04MzM4PV1CR0JHQl2NWGdYWGdYjX2Xe3N7l33gsJycsOD/2c7Z//////////////8BGxsbGxwbHiEhHiotKC0qPTgzMzg9XUJHQkdCXY1YZ1hYZ1iNfZd7c3uXfeCwnJyw4P/Zztn////////////////CABEIAM0BMAMBIgACEQEDEQH/xAAaAAACAwEBAAAAAAAAAAAAAAAAAwECBAUG/9oACAEBAAAAAOJMzdmvY5tqTFYrStYCbuYwAAA8gTazNO17L4qaL1itKwE2rbeABAHk4kvfRue2/NatzIrWtQIo/cAAAeUgLMfu0NvhvObTatKwLH1fpAAAPK1C13btTb5iU5KrrQbfS9exkkAAHlqha7d2prM1QzoVmZbUabU2MAAAPLVCWM263MThdfPXBpnLsY5ZtZIAAHlYCbs2bHMrzdVFIrehD2QbWWACAPJgSxmrc5i8tjKnoZS6IfY2tkAADyATLG6dz7pXNMWnQuJyL0VvubYAICfGSTLW6dmm+emRyH6oUlJbHo6zbgAAeLC0se/Zpvkxs2JXG9PK3sRz2dp9wAAnxQTLXaNWm+NDZ2M5L0L6mPC5GzqNkkADxYFrvfq0sy3yu0syIo1yFIhXU6VyQAnxYE3e/Vprmu/Vde3jx0saU1yKntbJkJA8YBN3aNbF3Tofom/PjRnzqlVE6Oy2QkDxoTN3atASh49jr0x41OlFIX2tZMgT40mZtp2g+tK6rpiFpot8URdPT6UzJIePJmWb9GW+7Exex1iEYVsZlqq69PYYTIHkSZnVvnK+8PyxrddWRdozzlreLdjTJIHkiZfvtmZu5vQU2g4otVshXNVhbq7ZkCfJl9u/Hoys0ZzVkY3SpKs81WmhLLdXZMgT5SeptjNzm7Kw+R9cY1LMAb5pmboe2SQPLN7LMqMDeqi+rXJnXRGbTCt2ita3paLWAny+rrwlHPnqP2TMRkihzX6NjU2hNl2sMAnzPU1wyOdh6evYUbjqpYm3VEgIJL1bYD//xAAYAQEBAQEBAAAAAAAAAAAAAAAAAQIDBP/aAAoCAhADEAAAAJZSKJUJQVAA3mFipc6suVhZbkAN5JYqWazdYsmpbEADeSUDn1jWKM2rkAN5JSF5dNQsBLAA3AiWWVJZd4l1IADcEllMaXOqudZsSUA6SElllzoN5zbLLJYA3kJZc6JbLCwsJYDeQlzrNJSks1nUiaA3iXOjOiFlsudTWQzoDpjz9l68sbs1ExpbNZsCWUN58/Y7cpq5OfSN5s1kAlg//8QAMxAAAgIBAwIEBQMDBAMAAAAAAQIAEQMSITEEQRMiMFEQIDJhcRRAgSNSsUKRoeFiwfH/2gAIAQEAAT8A+QQTFFMEHwLgGiflMPzrFisDwfmv0hBMcSCD4dQQWCxWZeIjh/z8T8D8wNR8h4E6Q7v+wEExxIIPhnvx2/AigERgVOpbmPKHH3+Q/LdSyY6kD7Tox5Cfc/sBBEmOCD4ZUvOT9hFAAhAMYeG1iK4YfE/I+QJtyTwIuo88/wCIFWOPKZ0404kH7AQROZjiwfDNs6n3E0g7yhMguBi3lGx7GL1eSiNFkRuuerCifrMtC63g6nOWA1Cp+qy6iJ4rV5uYtJud8h/4mI78TzHuKjBq2MTYAQeuIIkxxYIJ1J0hD21QEUDvAP8AyhEbCLu5pxjcLNSP1CrQIEK2Te4DadpiUHJpaiAswkHY/Vc8JGPa+xhw0SbuY1FRlPaB/wCoqVBB6Z+QQRZiMWCCdQCcZr3EORwxFmIXZTqacXvH51E7XNtt6ANTGqr1RPbePj0MRW5OoTFeUudgCBUXbqXHEH3PvftFOmy11cu+NvtHyFeRMRDPd9osHp38gggmOLBBH+kyreAaRtCb7R23AXcxmHiaWAO86vHS+KljSZma/DbbSUgbwsOXJp2pRU6fFoxF2+o7zGWe6orA4ckHmKaIAuOiEX3mDvFg9O5fxEEExmJBBMzBUMxgEaoT2qVQi2uUkrtOtRlbFlWZE14WX3BETG64EVjwTMuDViVBsLF39p1Pk6dtPtOkULgtgd96gVtZLChcN3YG8BsETp2FsIIPTuXLlwGAwTGYhggmXzUJVAgQAA1M3U48VDdnPCiP1OdN/CRfzMWZM9Y8uPSTx3BmZCijT2qA6u0zPpFKN54QyY6cc7zL1tWuDFqA5aL1OUgs2FW+4gz48i+W5uADfHMxkBgYIPTuXLlwGAxZjMQwGXHbzGKwSyTtP1GXLkKYth7xsYTqsVk7qZ1Wc4iwCWWFAzEv9Ahuyzpc3j9NZ5jiqqEWB+Z1uajjwjYNzM+tcCqgFA+YTpgVxOX4VDPBH6RCeb2iZnQlG3mNqoRTsIPUuXLgMWLEiGKZcyNvvMxL0BMathrT/MZR1OMAtpdeDGGTbx+mYn+5JmObJjKY8JRO9zocoxlscJBhYCZyc+b2OwiYusUBSiZBGwPQOdgEG4xpOozFtgNhsBGQsC2rcTE24iMGAqD9gsWJEMU/DMxUjvURi7ljsBGx52bUHH4iZAGo7HuJjzMLmXIHxkEdpo8IFr3JiZbAmV63iLrcGrn6hgo0zJnZr2swnU9MdMGJVvSbmgre+06bP2MVr/YLFixIvwZkYsN5jOIoe0/rZXIUkCfpHWqJmPEFFuBMTByw0kAd/edYhrUBtMSKRs4mdFUWz1OkxtpDkVMz6WTYG/YzIuN6I3nhYwNxU0lLKvCxKktFbSZ0+e9orX66xYsSLHbaDyMCeDDhs3wsGLa8bCYyQKYgxqKnUliKmO2pHHEVVdd1nVYB0znKo2InTYB1OQZnHlAoR1obCFWFFcKcGMXoWqieGchr/wBxsJUUFuZLGxsCFYjlTMGXUID6yxYkSau0yELQMdmKAKOfaI1eV2v2AgxmtWqkmJtO3MrUOa+8sjkmHKALup1WUsjAW06fIVxqCrLPFDcbzJ5+bH87QsQaDG/Ycw633IDr/euxH5hcqKxtqMLLVXpP24/kQrxqUfYiMntvOnyaTEax6wizGsuoptxOpQAgtAHyYtv9oFVTtRI7nj+B3gutRcjbk8n8RQxreh7Dv+YpcWxOw9v8CDPvTCAYm3MISozKBMmXGvFXHyltwdxDTAXtX/H/AFFzMx0k6XHDwqD9YAb3GwMfYkML+/eIxX7rMi9wYjb78zA1qPWExrFFCMamP6x7zqMWoXdTC4A0gTKNBvkxCT5ibP3gXVueTCDWkHYR1J7Q69qhOXbeMMpu2hvvC24gBJiVsK37GNkYCiPL7+04G/H+9f8AUNhtv/onKGu0E6V+0B9VBZmNIRQhclqAiEhgY15EhvGTR80RWYeaG1bmhMbAjaLREraFRYmkTKQFMzDUDUBtRY3mNKNzKoCrUfzHYzVQ0niUb0n+Ip57GEUZ070wiGx6gmJIlCORUQ7mZlZcSmphyGgK3jppbVEFpcyjfaK7AAQZBUDWJcZ/8x2YsQOLh22q5jQFamNjuoAsdoXKkiu8UaAT2mR9RuA6l09+0U2Ll9jxENNMLWo9MREN7zElzLjYCxFZu8xgapkF44jHE02yY5iyBW0NGUNxDiqBK/Jg1ACWxgQ8n8x/KB27gQHU5J7mHJ4b19o5Ou1NXvArMCTMmSxpHEJgMujfvz8B2nTnaD0VQtMXTE9ouBKmUv07WOIM4dItMxhJB4niCpkUN9Mws2LkbR8PijUDBlbG1E7CL1Kkxcwbg7magIcojZqB3smMbIZ22E1NqauJuRZI2hKqp3gzErpjH2+FfAbxVNzAKHojmdNjUC2mtZr33nV745jfykTp2Os3Kpt+DGQj6dxEJR94+TCO9mYkz/hYem1sde4idLiUbKJkRSaKiPrxkqNxF1tQreoMWndqgOJ3KslGZOnxum0KthffdZnxV5hOmxnKxHA7xegw3d3D0WE1SVD0eI2ACDD0jAzH0zDmDABFWpfoYxvcwqWUE8RqriZWNbQvrUqZ9DkGI2lwYNDrCNJ8rRMWVpi6ZEIYi2nA4g22jccCUCPxxtCNN0AIS44AjAXqddoSBmo8HgxCUYoeDxMqahGG2jvUwYUw4wvJPMAo8D3Mqxd7+0I4NVBXaHYTV8LgPz4F1sB95mOlVVZ/pnhajzM3TFDqBmbmY+1xcAZAQ0wYkH5gH2h4gJ7Ccm+BHcXQPAmo3GND7xp23n1NoJYVxE1kWzbj3gDsQFmLCmMd7PejZhZAAQCYSLNCu5PYzleGv/EaKVBO81ijfMB83EBINGEwNAZfxuVRInQKNczizDbYxMa0s5YzqsahrhWdHfhmYvqaVtcOykxWIM7NHYgn8RRShveOT5TCxuBmphfcQgahtF3yaaiquLR3s1DkPinECRsDd7wZGcM3dXoRr232JowhqI1GwCblWFPY9vaXTMPYyvNO4nG/wEHy/wD/xAAeEQEAAgICAwEAAAAAAAAAAAABABEQMCAxAkBBIf/aAAgBAgEBPwDitQfSZUHgwNj1kcLD0DDucBLwW/kYbGUVBpufFlzqql3tcNT7UAufYVCJsqVAlSpUNbwGXxfRNChLwx/Z3KcVK1eTDNSsKYIaPLpiTxah1PtZW8HNz//EAB0RAQACAgMBAQAAAAAAAAAAAAEAERAwAiAxQEH/2gAIAQMBAT8A6hcSu1bDCdA2nuUwfC/AYUy0QjsPZc5FziVKiXAraYMN1PyODcstqpeHekrqaTQ6awQxZm9XEjm8gxjHRx9gxLj7PzIVh1f/2Q==" alt="QuanMD">
                </div>
                <div class="info__username">
                    <span>QuanMD</p>
                </div>
                <div class="info_settings">
                    <button class="remove-css-button">...</button>
                </div>
            </div>
            <ul id="user-list"></ul>
        </div>
        <div class="chat__homepage">
        </div>
        <div class="chat__main">
            <div class="chat-nav">
                <ul>
                  <li><button id="audio-call" class="call"><i class="phone icon"></i></button></li>
                  <li><button id="video-call" class="call"><i class="video icon"></i></button></li>
                </ul>
            </div>
            <div id="messages" class="chat__messages"></div>
            <div class="chat__callnotification">
                <div id="incomming-call-notification">
                    <div class="notification__header">
                        <span id="caller-name"></span> is calling...
                    </div>
                    <div class="notification__content">
                        <button id="answer-call"><i class="phone icon answer-call"></i></button>
                        <button id="reject-call"><i class="phone icon reject-call"></i></button>
                    </div>
                </div>
                <div id="calling-notification">
                    <div class="notification__header">
                        Calling <span id="receiver-name"></span>
                    </div>
                    <div class="notification__content">
                        <button id="cancel-call"><i class="phone icon cancel-call"></i></button>
                    </div>
                </div>
            </div>
        
            <audio id="ringtone" preload="auto">
                <source src="/media/iphone.mp3" type="audio/mpeg">
            </audio>
            
            <button class="scroll-to-bottom-button"><i class="arrow alternate circle down outline icon"></i></button>

            <div class="compose">
                <form id="message-form">
                    <button type="button" id="openInputFileButton" title="Upload File"><i class="paperclip icon"></i></button>
                    <input id="fileInput" type="file" multiple="" style="display: none;" title="File Input"/>
                    <input name="message" id="message" placeholder="Message" title="Message" autocomplete="false" />
                    <button type="button" id="sendMessage" title="Send Message">Send</button>
                </form>
            </div>
        </div>
    </div>

    <script id="message-template" type="x-tmpl-mustache">
        <div class="message" id="message-{{id}}">
            <div class="message__container" id="message__container-{{id}}">
                <div class="message__header">
                    <span class="message__username">{{username}}</span>
                    <span class="message__meta">{{createdAt}}</span>
                </div>
                <div class="message__content">
                    {{#type_text}}
                        {{message}}
                    {{/type_text}}
                    {{#imageFiles}}
                        <img class="message__imgfile" src="{{urlFilePath}}" alt="{{originalFileName}}"/>
                    {{/imageFiles}}
                    {{#otherFiles}}
                        <div class="message__otherfile">
                            <div class="preview__icon">
                                <i class="file icon"></i>
                            </div>
                            <div class="preview__content">
                                <a href="{{urlFilePath}}" target="_blank" download>{{originalFileName}}</a>
                            </div>
                        </div>
                    {{/otherFiles}}
                </div>
            </div>
            {{#type_text}}
            <div class="message__action" id="message__action-{{id}}">
                <button class="message__reactionbutton" title="Add reaction" id="message__reactionbutton-{{id}}">
                    <i class="smile outline icon"></i>
                </button>
                <div class="message__reactionlist" id="message__reactionlist-{{id}}">
                    <div class="emoji like">
                        <div class="icon" data-title="Like"></div>
                    </div>
                    <div class="emoji love">
                        <div class="icon" data-title="Love"></div>
                    </div>
                    <div class="emoji haha">
                        <div class="icon" data-title="Haha"></div>
                    </div>
                    <div class="emoji wow">
                        <div class="icon" data-title="Wow"></div>
                    </div>
                    <div class="emoji sad">
                        <div class="icon" data-title="Sad"></div>
                    </div>
                    <div class="emoji angry">
                        <div class="icon" data-title="Angry"></div>
                    </div>
                </div>
                <button class="message__morebutton" id="message__morebutton-{{id}}" title="More">
                    <i class="ellipsis vertical icon"></i>
                </button>
                <div class="message__dropdownlist" id="message__dropdownlist-{{id}}">
                    <div class="reaction">Add reaction</div>
                    <div class="edit">
                        <i class="edit icon"></i>Edit
                    </div>
                    <div class="delete">
                        <i class="trash icon"></i>Delete
                    </div>
                </div>
            </div>
            <div class="message__reactions" id="message__reactions-{{id}}"></div>
            {{/type_text}}
        </div>
    </script>

    <script id="user-template" type="text/template">
        {{#users}}
        <li class="user" id={{id}}>
            <span>{{username}}</span> <br/>
            <i class="{{#online}}fas fa-circle online{{/online}}{{^online}}fas fa-circle offline{{/online}}"></i>&nbsp&nbsp{{#online}}online{{/online}}{{^online}}offline{{/online}}
        </li>
        {{/users}}
    </script>

    <script id="settings-template" type="text/template">
        <div class="settings" id="settings">
            <div id="user-info">
                <button class="remove-css-button">User Info</button>
            </div>
            <div id="logout-btn">
                <button class="remove-css-button">Logout</button>
            </div>
        </div>
    </script>

    <script id="user-settings-popup-template" type="text/template">
        <div id="user-settings-popup" class="popup">
            <form id="user-settings-form" method="post" autocomplete="off">
                <div class="popup-content">
                    <span class="close" id="closePopupBtn">&times;</span>
                    <h2>Change User Settings</h2>
                    <label for="username">Username:</label>
                    <input type="text" id="username" value="{{username}}" readonly/>
                    <label for="email">Email:</label>
                    <input type="email" id="email" value="{{email}}" readonly/>
                    <label for="avatar">Avatar URL:</label>
                    <input type="text" id="avatar" />
                    <label for="currentPassword">Current Password:</label>
                    <input type="password" id="currentPassword" autocomplete="off"/>
                    <label for="newPassword">New Password:</label>
                    <input type="password" id="newPassword" autocomplete="off"/>
                    <label for="confirmPassword">Confirm Password:</label>
                    <input type="password" id="confirmPassword" autocomplete="off"/>
                    <button id="saveChangesBtn">Save Changes</button>
                </div>
            </form>
        </div>
    </script>
</body>

</html>